<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¬ Candy Crush - GhÃ©p Káº¹o</title>
    <link rel="stylesheet" href="candy-crush.css">
    <link rel="stylesheet" href="candy-crush-responsive-v2.css">
</head>

<body>
    <div class="game-container">
        <!-- Header -->
        <div class="game-header">
            <button class="back-btn" onclick="goBack()">â† Quay láº¡i</button>
            <h1>ğŸ¬ GhÃ©p Káº¹o Ngá»t</h1>
            <button class="reset-btn" onclick="resetGame()">ğŸ”„ ChÆ¡i láº¡i</button>
        </div>

        <!-- Game Info -->
        <div class="game-info">
            <div class="info-item">
                <div class="info-label">Äiá»ƒm</div>
                <div class="info-value" id="candyScore">0</div>
            </div>
            <div class="info-item">
                <div class="info-label">NÆ°á»›c</div>
                <div class="info-value" id="candyMoves">30</div>
            </div>
            <div class="info-item">
                <div class="info-label">Má»¥c tiÃªu</div>
                <div class="info-value">1000</div>
            </div>
        </div>

        <!-- Progress Bar -->
        <div class="progress-container">
            <div class="progress-label">Tiáº¿n Ä‘á»™</div>
            <div class="progress-bg">
                <div class="progress-bar" id="candyProgress"></div>
            </div>
        </div>

        <!-- Game Board -->
        <div class="board-container">
            <canvas id="candyCanvas" width="480" height="480"></canvas>
        </div>

        <!-- Instructions -->
        <div class="instructions">
            <p>ğŸ‘† Click 2 káº¹o liá»n ká» Ä‘á»ƒ Ä‘á»•i chá»—</p>
            <p>ğŸ¯ GhÃ©p 3 káº¹o giá»‘ng nhau Ä‘á»ƒ ná»•!</p>
            <p>â­ GhÃ©p nhiá»u hÆ¡n = Ä‘iá»ƒm cao hÆ¡n!</p>
        </div>
    </div>

    <script src="candy-crush-complete.js"></script>
    <script src="candy-device-detector-v2.js"></script>
    <script src="candy-swipe-desktop-v2.js"></script>
    <script src="candy-swipe-mobile-v2.js"></script>
    <script src="candy-swipe-unified-v2.js"></script>
    <script src="game-sync.js"></script>
    <script>
        let game = null;
        let deviceDetector = null;

        // Khá»Ÿi táº¡o game vá»›i responsive system V2
        window.addEventListener('load', function () {
            if (window.CandyCrushComplete && window.CandyDeviceDetectorV2) {
                // Initialize device detector V2
                deviceDetector = new window.CandyDeviceDetectorV2();

                // Apply device class
                document.body.className = deviceDetector.getDeviceClass();

                // Get canvas element
                const canvas = document.getElementById('candyCanvas');
                const config = deviceDetector.canvasConfig;

                // Set canvas size tá»« device detector
                canvas.width = config.canvasSize;
                canvas.height = config.canvasSize;
                canvas.classList.add('loading');

                console.log(`âœ… Canvas initialized: ${config.canvasSize}x${config.canvasSize}px`);

                // Create game instance
                game = new window.CandyCrushComplete();

                // Pass config to game
                game.config.CELL_SIZE = config.cellSize;
                game.config.CANDY_SIZE = config.candySize;
                game.config.HIT_AREA = config.hitArea;

                // Init game
                game.init('candyCanvas');

                // Mark canvas as ready
                setTimeout(() => {
                    canvas.classList.remove('loading');
                    canvas.classList.add('ready');
                }, 100);

                // Setup Swipe Handler V2 (Unified)
                const swipeHandler = new window.CandySwipeUnified(canvas, game);

                // Log handler info
                const handlerInfo = swipeHandler.getInfo();
                console.log(`ğŸ® Swipe Handler: ${handlerInfo.handler}`);
                console.log(`ğŸ“± Input Type: ${handlerInfo.type}`);
                console.log(`ğŸ“ Threshold: ${handlerInfo.threshold}px`);

                console.log('ğŸ¬ Candy Crush Complete ready!');
                console.log('âœ¨ Try to match 4 for Striped Candy!');
                console.log('âœ¨ Try to match 5 for Color Bomb!');
                console.log('ğŸ‘† Swipe to play - just like real Candy Crush!');
            }
        });

        function goBack() {
            window.location.href = 'index.html';
        }

        function resetGame() {
            if (game) {
                game.reset();
            }
        }
    </script>
</body>

</html>