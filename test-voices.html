<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Gi·ªçng ƒê·ªçc Ti·∫øng Vi·ªát</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            color: white;
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .subtitle {
            text-align: center;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 30px;
            font-size: 1.1rem;
        }

        .test-box {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
        }

        .test-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 12px;
            font-size: 1.1rem;
            margin-bottom: 15px;
            font-family: inherit;
        }

        .test-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        button {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            flex: 1;
            min-width: 150px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #FF9F43, #FF6B6B);
            color: white;
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4);
        }

        .voice-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .voice-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 12px;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.3s;
        }

        .voice-item:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .voice-item.female {
            background: linear-gradient(135deg, #ffeef8, #fff5f8);
            border-color: #ff69b4;
        }

        .voice-item.recommended {
            background: linear-gradient(135deg, #e8f5e9, #f1f8e9);
            border-color: #4caf50;
        }

        .voice-name {
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
            font-size: 1.1rem;
        }

        .voice-lang {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 8px;
        }

        .voice-tags {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
        }

        .tag {
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: bold;
        }

        .tag-female {
            background: #ff69b4;
            color: white;
        }

        .tag-recommended {
            background: #4caf50;
            color: white;
        }

        .tag-default {
            background: #ffc107;
            color: white;
        }

        .tag-vi {
            background: #2196f3;
            color: white;
        }

        .info-box {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid #2196f3;
        }

        .info-box h3 {
            color: #1976d2;
            margin-bottom: 10px;
        }

        .info-box ul {
            margin-left: 20px;
            color: #333;
        }

        .info-box li {
            margin: 5px 0;
        }

        .status {
            padding: 12px;
            border-radius: 8px;
            margin: 10px 0;
            font-weight: bold;
        }

        .status-success {
            background: #d4edda;
            color: #155724;
        }

        .status-info {
            background: #d1ecf1;
            color: #0c5460;
        }

        .status-warning {
            background: #fff3cd;
            color: #856404;
        }

        .emoji {
            font-size: 3rem;
            text-align: center;
            margin: 20px 0;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>üé§ Test Gi·ªçng ƒê·ªçc Ti·∫øng Vi·ªát</h1>
        <p class="subtitle">T√¨m gi·ªçng n·ªØ d·ªãu d√†ng ph√π h·ª£p cho tr·∫ª em</p>

        <div class="test-box">
            <h2>üéµ Test Nhanh</h2>
            <input type="text" class="test-input" id="testText"
                value="Xin ch√†o c√°c b√©! H√¥m nay ch√∫ng ta c√πng h·ªçc ƒë√°nh v·∫ßn nh√©!" placeholder="Nh·∫≠p c√¢u mu·ªën test...">

            <div class="btn-group">
                <button class="btn-primary" onclick="testTTSServer()">
                    üéµ TTS Server (Google)
                </button>
                <button class="btn-secondary" onclick="testBestVoice()">
                    ‚≠ê Gi·ªçng T·ªët Nh·∫•t
                </button>
                <button class="btn-secondary" onclick="loadAllVoices()">
                    üìã Xem T·∫•t C·∫£ Gi·ªçng
                </button>
            </div>

            <div id="status"></div>
        </div>

        <div class="test-box">
            <div class="info-box">
                <h3>üí° Gi·ªçng N·ªØ Ti·∫øng Vi·ªát ƒê∆∞·ª£c Khuy·∫øn Ngh·ªã:</h3>
                <ul>
                    <li><strong>Chrome/Edge:</strong> "Google ti·∫øng Vi·ªát" ho·∫∑c "Microsoft Linh/An Online"</li>
                    <li><strong>Windows:</strong> "Linh" ho·∫∑c "An" (c√†i ƒë·∫∑t trong Windows Settings)</li>
                    <li><strong>macOS/iOS:</strong> "Ting-Ting" ho·∫∑c "Sin-Ji"</li>
                    <li><strong>Android:</strong> C√†i ƒë·∫∑t "Google Text-to-Speech" v√† t·∫£i gi·ªçng Vi·ªát</li>
                </ul>
            </div>

            <h2>üé§ Danh S√°ch Gi·ªçng C√≥ S·∫µn</h2>
            <div id="voiceList" class="voice-list"></div>
        </div>

        <div class="test-box">
            <h2>üìä Th√¥ng Tin H·ªá Th·ªëng</h2>
            <div id="systemInfo"></div>
        </div>
    </div>

    <script>
        let voices = [];
        let preferredVoice = null;

        // Load voices
        function loadVoices() {
            voices = speechSynthesis.getVoices();

            if (voices.length === 0) {
                setTimeout(loadVoices, 100);
                return;
            }

            // T√¨m gi·ªçng n·ªØ Vi·ªát Nam t·ªët nh·∫•t
            const femaleVoiceNames = [
                'Google ti·∫øng Vi·ªát',
                'Microsoft Linh Online',
                'Microsoft An Online',
                'Linh',
                'An',
                'Ting-Ting',
                'Sin-Ji'
            ];

            for (let name of femaleVoiceNames) {
                const voice = voices.find(v =>
                    v.name.includes(name) && v.lang.startsWith('vi')
                );
                if (voice) {
                    preferredVoice = voice;
                    break;
                }
            }

            if (!preferredVoice) {
                preferredVoice = voices.find(v => v.lang.startsWith('vi'));
            }

            showSystemInfo();
        }

        // Test TTS Server
        function testTTSServer() {
            const text = document.getElementById('testText').value;
            showStatus('‚è≥ ƒêang ph√°t √¢m v·ªõi TTS Server (Google)...', 'info');

            const audio = new Audio('/api/tts?text=' + encodeURIComponent(text));

            audio.addEventListener('canplaythrough', function () {
                audio.play().then(() => {
                    showStatus('‚úÖ ƒêang ph√°t √¢m v·ªõi TTS Server!', 'success');
                }).catch(e => {
                    showStatus('‚ùå Kh√¥ng th·ªÉ play: ' + e.message, 'warning');
                });
            });

            audio.addEventListener('error', function () {
                showStatus('‚ùå TTS Server kh√¥ng kh·∫£ d·ª•ng. Vui l√≤ng ch·∫°y: node server.js', 'warning');
            });
        }

        // Test best voice
        function testBestVoice() {
            const text = document.getElementById('testText').value;

            if (!preferredVoice) {
                showStatus('‚ö†Ô∏è Kh√¥ng t√¨m th·∫•y gi·ªçng ti·∫øng Vi·ªát!', 'warning');
                return;
            }

            showStatus('‚è≥ ƒêang ph√°t √¢m v·ªõi: ' + preferredVoice.name, 'info');

            const utterance = new SpeechSynthesisUtterance(text);
            utterance.voice = preferredVoice;
            utterance.lang = 'vi-VN';
            utterance.rate = 0.85;
            utterance.pitch = 1.15;
            utterance.volume = 1;

            utterance.onstart = function () {
                showStatus('‚úÖ ƒêang ph√°t √¢m v·ªõi: ' + preferredVoice.name, 'success');
            };

            utterance.onend = function () {
                showStatus('‚úÖ Ho√†n t·∫•t! Gi·ªçng: ' + preferredVoice.name, 'success');
            };

            speechSynthesis.speak(utterance);
        }

        // Test specific voice
        function testVoice(voice) {
            const text = document.getElementById('testText').value;

            showStatus('‚è≥ ƒêang ph√°t √¢m v·ªõi: ' + voice.name, 'info');

            const utterance = new SpeechSynthesisUtterance(text);
            utterance.voice = voice;
            utterance.lang = voice.lang;
            utterance.rate = 0.85;
            utterance.pitch = 1.15;
            utterance.volume = 1;

            utterance.onstart = function () {
                showStatus('‚úÖ ƒêang ph√°t √¢m v·ªõi: ' + voice.name, 'success');
            };

            speechSynthesis.speak(utterance);
        }

        // Load all voices
        function loadAllVoices() {
            const container = document.getElementById('voiceList');
            container.innerHTML = '';

            if (voices.length === 0) {
                container.innerHTML = '<p>ƒêang t·∫£i gi·ªçng...</p>';
                setTimeout(loadAllVoices, 500);
                return;
            }

            // L·ªçc v√† s·∫Øp x·∫øp
            const viVoices = voices.filter(v => v.lang.startsWith('vi'));
            const otherVoices = voices.filter(v => !v.lang.startsWith('vi'));

            // Hi·ªÉn th·ªã gi·ªçng Vi·ªát tr∆∞·ªõc
            viVoices.forEach(voice => {
                const isFemale = ['Linh', 'An', 'Ting', 'Sin', 'Google'].some(name =>
                    voice.name.includes(name)
                );
                const isRecommended = preferredVoice && voice.name === preferredVoice.name;

                const div = document.createElement('div');
                div.className = 'voice-item';
                if (isFemale) div.classList.add('female');
                if (isRecommended) div.classList.add('recommended');

                div.innerHTML = `
                    <div class="voice-name">${voice.name}</div>
                    <div class="voice-lang">${voice.lang}</div>
                    <div class="voice-tags">
                        ${isRecommended ? '<span class="tag tag-recommended">‚≠ê Khuy·∫øn ngh·ªã</span>' : ''}
                        ${isFemale ? '<span class="tag tag-female">üë© Gi·ªçng n·ªØ</span>' : ''}
                        ${voice.default ? '<span class="tag tag-default">M·∫∑c ƒë·ªãnh</span>' : ''}
                        <span class="tag tag-vi">üáªüá≥ Ti·∫øng Vi·ªát</span>
                    </div>
                `;

                div.onclick = () => testVoice(voice);
                container.appendChild(div);
            });

            // Hi·ªÉn th·ªã gi·ªçng kh√°c (n·∫øu mu·ªën)
            if (otherVoices.length > 0 && viVoices.length === 0) {
                const warning = document.createElement('div');
                warning.className = 'status status-warning';
                warning.textContent = '‚ö†Ô∏è Kh√¥ng t√¨m th·∫•y gi·ªçng ti·∫øng Vi·ªát. Hi·ªÉn th·ªã gi·ªçng kh√°c:';
                container.appendChild(warning);

                otherVoices.slice(0, 10).forEach(voice => {
                    const div = document.createElement('div');
                    div.className = 'voice-item';
                    div.innerHTML = `
                        <div class="voice-name">${voice.name}</div>
                        <div class="voice-lang">${voice.lang}</div>
                    `;
                    div.onclick = () => testVoice(voice);
                    container.appendChild(div);
                });
            }
        }

        // Show system info
        function showSystemInfo() {
            const info = document.getElementById('systemInfo');
            info.innerHTML = `
                <div class="status status-info">
                    <strong>T·ªïng s·ªë gi·ªçng:</strong> ${voices.length}<br>
                    <strong>Gi·ªçng ti·∫øng Vi·ªát:</strong> ${voices.filter(v => v.lang.startsWith('vi')).length}<br>
                    <strong>Gi·ªçng ƒë∆∞·ª£c ch·ªçn:</strong> ${preferredVoice ? preferredVoice.name : 'Kh√¥ng c√≥'}<br>
                    <strong>Tr√¨nh duy·ªát:</strong> ${navigator.userAgent.split(' ').pop()}<br>
                    <strong>Ng√¥n ng·ªØ:</strong> ${navigator.language}
                </div>
            `;
        }

        // Show status
        function showStatus(message, type) {
            const status = document.getElementById('status');
            status.innerHTML = `<div class="status status-${type}">${message}</div>`;
        }

        // Init
        if (speechSynthesis.onvoiceschanged !== undefined) {
            speechSynthesis.onvoiceschanged = loadVoices;
        }
        loadVoices();

        window.addEventListener('load', function () {
            setTimeout(loadVoices, 500);
            setTimeout(loadAllVoices, 1000);
        });
    </script>
</body>

</html>